"use strict";var __decorate=this&&this.__decorate||function(e,a,s,r){var t,n=arguments.length,o=n<3?a:null===r?r=Object.getOwnPropertyDescriptor(a,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,a,s,r);else for(var i=e.length-1;i>=0;i--)(t=e[i])&&(o=(n<3?t(o):n>3?t(a,s,o):t(a,s))||o);return n>3&&o&&Object.defineProperty(a,s,o),o},__metadata=this&&this.__metadata||function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),classes_1=require("./classes"),ColorPickerService=function(){function e(){}return e.prototype.hsla2hsva=function(e){var a=Math.min(e.h,1),s=Math.min(e.s,1),r=Math.min(e.l,1),t=Math.min(e.a,1);if(0===r)return new classes_1.Hsva(a,0,0,t);var n=r+s*(1-Math.abs(2*r-1))/2;return new classes_1.Hsva(a,2*(n-r)/n,n,t)},e.prototype.hsva2hsla=function(e){var a=e.h,s=e.s,r=e.v,t=e.a;if(0===r)return new classes_1.Hsla(a,0,0,t);if(0===s&&1===r)return new classes_1.Hsla(a,1,1,t);var n=r*(2-s)/2;return new classes_1.Hsla(a,r*s/(1-Math.abs(2*n-1)),n,t)},e.prototype.rgbaToHsva=function(e){var a,s,r=Math.min(e.r,1),t=Math.min(e.g,1),n=Math.min(e.b,1),o=Math.min(e.a,1),i=Math.max(r,t,n),c=Math.min(r,t,n),h=i,l=i-c;if(s=0===i?0:l/i,i===c)a=0;else{switch(i){case r:a=(t-n)/l+(t<n?6:0);break;case t:a=(n-r)/l+2;break;case n:a=(r-t)/l+4}a/=6}return new classes_1.Hsva(a,s,h,o)},e.prototype.hsvaToRgba=function(e){var a,s,r,t=e.h,n=e.s,o=e.v,i=e.a,c=Math.floor(6*t),h=6*t-c,l=o*(1-n),u=o*(1-h*n),f=o*(1-(1-h)*n);switch(c%6){case 0:a=o,s=f,r=l;break;case 1:a=u,s=o,r=l;break;case 2:a=l,s=o,r=f;break;case 3:a=l,s=u,r=o;break;case 4:a=f,s=l,r=o;break;case 5:a=o,s=l,r=u}return new classes_1.Rgba(a,s,r,i)},e.prototype.stringToHsva=function(e,a){void 0===e&&(e=""),void 0===a&&(a=!1);var s=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return new classes_1.Rgba(parseInt(e[2])/255,parseInt(e[3])/255,parseInt(e[4])/255,isNaN(parseFloat(e[5]))?1:parseFloat(e[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return new classes_1.Hsla(parseInt(e[2])/360,parseInt(e[3])/100,parseInt(e[4])/100,isNaN(parseFloat(e[5]))?1:parseFloat(e[5]))}}];a?s.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(e){return new classes_1.Rgba(parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,parseInt(e[4],16)/255)}}):s.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(e){return new classes_1.Rgba(parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1)}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(e){return new classes_1.Rgba(parseInt(e[1]+e[1],16)/255,parseInt(e[2]+e[2],16)/255,parseInt(e[3]+e[3],16)/255,1)}}),e=e.toLowerCase();var r=null;for(var t in s)if(s.hasOwnProperty(t)){var n=s[t],o=n.re.exec(e),i=o&&n.parse(o);if(i)return i instanceof classes_1.Rgba?r=this.rgbaToHsva(i):i instanceof classes_1.Hsla&&(r=this.hsla2hsva(i)),r}return r},e.prototype.outputFormat=function(e,a,s){if(e.a<1)switch(a){case"hsla":var r=this.hsva2hsla(e),t=new classes_1.Hsla(Math.round(360*r.h),Math.round(100*r.s),Math.round(100*r.l),Math.round(100*r.a)/100);return"hsla("+t.h+","+t.s+"%,"+t.l+"%,"+t.a+")";default:if(s&&"hex"===a)return this.hexText(this.denormalizeRGBA(this.hsvaToRgba(e)),s);var n=this.denormalizeRGBA(this.hsvaToRgba(e));return"rgba("+n.r+","+n.g+","+n.b+","+Math.round(100*n.a)/100+")"}else switch(a){case"hsla":var r=this.hsva2hsla(e),t=new classes_1.Hsla(Math.round(360*r.h),Math.round(100*r.s),Math.round(100*r.l),Math.round(100*r.a)/100);return"hsl("+t.h+","+t.s+"%,"+t.l+"%)";case"rgba":var n=this.denormalizeRGBA(this.hsvaToRgba(e));return"rgb("+n.r+","+n.g+","+n.b+")";default:return this.hexText(this.denormalizeRGBA(this.hsvaToRgba(e)),s)}},e.prototype.hexText=function(e,a){var s="#"+(1<<24|e.r<<16|e.g<<8|e.b).toString(16).substr(1);return s[1]!==s[2]||s[3]!==s[4]||s[5]!==s[6]||1!==e.a||a||(s="#"+s[1]+s[3]+s[5]),a&&(s+=(256|Math.round(255*e.a)).toString(16).substr(1)),s},e.prototype.denormalizeRGBA=function(e){return new classes_1.Rgba(Math.round(255*e.r),Math.round(255*e.g),Math.round(255*e.b),e.a)},e}();ColorPickerService=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],ColorPickerService),exports.ColorPickerService=ColorPickerService;